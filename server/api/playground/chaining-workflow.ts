export default defineEventHandler(async (event) => {
  const prompts = [
    // 第一步：提取
    `
      从客户反馈中提取以下关键信息：
      1. 日期：反馈日期
      2. 用户：用户名（或匿名）
      3. 类别：问题类别（例如，性能问题、功能请求、用户体验问题、技术问题）
      4. 描述：具体问题描述
    `,
    // 第二步：计数与总结
    `
      按类别合并以下反馈。
      统计每个类别的反馈数量。
      总结所有反馈的类别。
    `,
    // 第三步：排序
    `
    根据反馈数量对类别进行降序排序。
    对于每个类别，
    `,
    // 第四步：生成建议
    `
      为每个类别生成可行的改进建议。
      对于每个类别，展示：
      1. 类别名称
      2. 反馈数量
      3. 简要总结
      4. 建议
    `,
  ]

  const input = `
    1. 2025年1月3日，约翰报告称产品加载速度缓慢，尤其是在移动设备上。
    2. 2025年1月5日，史密斯先生建议添加一个导出报告的功能，以便更好地进行数据分析。
    3. 2025年1月8日，布朗女士提到偶尔会出现登录失败的情况，需要多次尝试才能成功。
    4. 2025年1月10日，一位匿名用户要求设计一个更简洁的界面，减少不必要的按钮。
    5. 2025年1月12日，莎拉报告称搜索功能在处理复杂查询时无法返回准确结果。
    6. 2025年1月15日，一位匿名用户抱怨整个应用程序缺乏深色模式支持。
  `

  const result = await chainingWorkflow(input, prompts)

  return result
})
